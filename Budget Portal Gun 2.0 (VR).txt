-- Services
local cs = game:GetService("CollectionService")
local ts = game:GetService("TweenService")
local de = game:GetService("Debris")
local UserInputService = game:GetService("UserInputService")
local VRService = game:GetService("VRService")
-- Objs
local player = game.Players.LocalPlayer
warn("Hawk Tuah")
warn("Controls (PC): LMB: Blue Portal | RMB: Orange Portal | R: Fizzle Portals | F: Flashlight | E: Pick Up Unanchored Parts | C: Zoom in")
warn("Controls (VR): Right Trigger: Blue Portal | B: Orange Portal | X: Fizzle Portals | Left Trigger: Flashlight | Y: Pick Up Unanchored Parts")
local mouse = player:GetMouse()
local portal1 = nil
local portal2 = nil
local tpcd = false
local toolequipped = false
local character = player.Character
local GrabObject = nil 
local GrabStart = false 
local Dragger = nil
local isHolding = false
local camera = game.Workspace.CurrentCamera
--TeleportSound
Teleport = Instance.new("Sound", workspace)
Teleport.Name = "woosh"
--Functions
local function canquerymysavior()
	for i, child in pairs(workspace:GetDescendants()) do
		if child:IsA("Part") or child:IsA("BasePart") or child:IsA("MeshPart") or child:IsA("WedgePart") or child:IsA("TrussPart") then
			if child.CanCollide == false then 
				child.CanQuery = false
			end
		end
	end
end
canquerymysavior()
local function createportal(rootpos,tpos,hitpart,ptype)
	local params = RaycastParams.new()
	params.FilterDescendantsInstances = {player.Character,portal1,portal2}	
	params.FilterType = Enum.RaycastFilterType.Exclude
	local ray = workspace:Raycast(rootpos,CFrame.new(rootpos,tpos).LookVector*9999999999,params)
	if ray then
		local rpos = ray.Position
		local rnorm = ray.Normal
		local dist = (rootpos-rpos).Magnitude
		-- Tween info
		local info = TweenInfo.new(dist/1070687350,Enum.EasingStyle.Linear,Enum.EasingDirection.InOut)
		local info2 = TweenInfo.new(0.333,Enum.EasingStyle.Circular,Enum.EasingDirection.Out)
		local orb = Instance.new("Part")
		orb.Size = Vector3.new(.7,.7,.7)
		orb.Position = rootpos
		orb.Anchored = true
		orb.Name = "PortalOrb"
		orb.CanCollide = false
		orb.Shape = Enum.PartType.Ball
		de:AddItem(orb,dist/1070687350)
		if ptype == 1 then
			orb.BrickColor = BrickColor.new("Bright blue")
		elseif ptype == 2 then
			orb.BrickColor = BrickColor.new("Neon orange")
		end
		orb.Material = Enum.Material.Neon
		orb.Parent = workspace
		local tween = ts:Create(orb,info,{Position=rpos})
		tween:Play()
		tween.Completed:Wait()
		if ptype == 1 then
			if portal1 == nil then
				portal1 = Instance.new("Part")
				portal1.Name = ("Blue1")
				sp1 = Instance.new("SpecialMesh", portal1)
				sp1.MeshType = "Sphere"
				sp1.Scale = Vector3.new(1,1.33,.05)
				sp1.Offset = Vector3.new(0,0,-0.02)
				idle1 = Instance.new("Sound", portal1)
				idle1.SoundId = "rbxassetid://148894502"
				idle1.Looped = true
				idle1.Volume = 0.2
				open1 = Instance.new("Sound", portal1)
				open1.SoundId = "rbxassetid://182981587"
				open1.PlaybackSpeed = 1.02
				open1.Volume = 0.35
				open1.PlayOnRemove = true 
				soundopen1 = Instance.new("Sound", portal1)
				soundopen1.SoundId = "rbxassetid://171399373"
				soundopen1.RollOffMinDistance = 30
				soundopen1.Volume = 0.6
				soundopen1:Play()
				portal1.Size = Vector3.new(.7,.7,.7)
				portal1.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				portal1.Anchored = true
				portal1.CanCollide = false	
				portal1.BrickColor = BrickColor.new("Bright blue")
				portal1.Material = Enum.Material.Neon
				portal1.Parent = workspace
				if character.Humanoid.RigType == Enum.HumanoidRigType.R15 then
					tpR15 = Instance.new("Part", portal1)
					tpR15.Size = Vector3.new(.7,.7,.7)
					tpR15.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
					tpR15.Anchored = true
					tpR15.CanCollide = false	
					tpR15.CanQuery = false
					tpR15.Transparency = 1
					local tween = ts:Create(tpR15,info2,{Size=Vector3.new(5,7,2.5),Transparency=1})
					tween:Play()
				end
				TP1 = Instance.new("Part", portal1)
				TP1.Transparency = 1
				TP1.CanCollide = false
				TP1.Size = Vector3.new(.5,.5,.5)
				TP1.Anchored = true 
				TP1.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				TP1.Orientation = Vector3.new(0,-90,0)
				velocheck = Instance.new("Part", portal1)
				velocheck.Transparency = 1
				velocheck.CanCollide = false
				velocheck.CanQuery = false
				velocheck.Anchored = true 
				velocheck.Orientation = Vector3.new(0,0,0)
				velocheck.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				velocheck.Size = Vector3.new(10,16,20)
				portalin1 = Instance.new("Part", portal1)
				portalin1.Size = Vector3.new(.5,.5,.5)
				portalin1.CanCollide = false
				portalin1.BrickColor = BrickColor.new("Bright blue")
				portalin1.Material = Enum.Material.Neon
				portalin1.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				portalin1.Orientation = Vector3.new(90,0,0)
				portalin1.Anchored = true 
				portalmesh1 = Instance.new("SpecialMesh", portalin1)
				portalmesh1.MeshType = "Sphere"
				portalmesh1.Scale = Vector3.new(1.1,6,.05)
				portalmesh1.Offset = Vector3.new(0,0,-0.02)
				portalin1.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				ESP1 = Instance.new("Highlight", portal1)
				ESP1.FillTransparency = 1
				ESP1.OutlineColor = Color3.fromRGB(65,222,253)
				if portal2 then
					portalin1.BrickColor = BrickColor.new("Really black")
					portalin2.BrickColor = BrickColor.new("Really black")
					game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683216197"
				else
					portalin1.BrickColor = BrickColor.new("Bright blue")
					portalin1.Material = Enum.Material.Neon
					game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683350503"
				end
				local tween = ts:Create(portalin1,info2,{Size=Vector3.new(4.1,1.23,2.5),Transparency=0})
				tween:Play()
				local tween = ts:Create(portal1,info2,{Size=Vector3.new(5,6,1),Transparency=0})
				tween:Play()
				idle1:Play()
				local velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
				velocheck.Touched:Connect(function(hit)
					velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
					task.wait(0.1)
				end)
				if character.Humanoid.RigType == Enum.HumanoidRigType.R15 then
					tpR15.Touched:Connect(function(hit)
						if hit.Parent == player.Character and portal2 and tpcd == false then	
							tpcd = true
							SoundRNG = math.random(1, 2)
							if SoundRNG == 2 then
								Teleport.SoundId = "rbxassetid://232806289"
							else 
								Teleport.SoundId = "rbxassetid://2769872789"
							end
							Teleport:Play()
							player.Character.HumanoidRootPart.CFrame = TP2.CFrame
							player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal2.CFrame.LookVector*(velocity*2.75)
							workspace.CurrentCamera.CFrame =  portal2.CFrame
							if portalin1.Orientation == Vector3.new(90,90,0) and portalin2.Orientation == Vector3.new(90,90,0) then
								wait(0.2)
								velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
								player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal2.CFrame.LookVector*(velocity*.1)
							end
							wait(0.2)
							tpcd = false
						end
					end)
				else
					portal1.Touched:Connect(function(hit)
						if hit.Parent == player.Character and portal2 and tpcd == false then	
							tpcd = true
							SoundRNG = math.random(1, 2)
							if SoundRNG == 2 then
								Teleport.SoundId = "rbxassetid://232806289"
							else 
								Teleport.SoundId = "rbxassetid://2769872789"
							end
							Teleport:Play()
							player.Character.HumanoidRootPart.CFrame = TP2.CFrame
							player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal2.CFrame.LookVector*(velocity*2.75)
							workspace.CurrentCamera.CFrame =  portal2.CFrame
							if portalin1.Orientation == Vector3.new(90,90,0) and portalin2.Orientation == Vector3.new(90,90,0) then
								wait(0.2)
								velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
								player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal2.CFrame.LookVector*(velocity*.1)
							end
							wait(0.2)
							tpcd = false
						end
					end)
				end
			else
				open1:Destroy()
				open1 = Instance.new("Sound", portal1)
				open1.SoundId = "rbxassetid://182981587"
				open1.PlaybackSpeed = 1.02
				open1.Volume = 0.35
				open1.PlayOnRemove = true 
				soundopen1:Play()
				portalin1:Destroy()
				TP1:Destroy()
				TP1 = Instance.new("Part", portal1)
				TP1.Transparency = 1
				TP1.CanCollide = false
				TP1.Size = Vector3.new(.5,.5,.5)
				TP1.Anchored = true 
				TP1.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				TP1.Orientation = Vector3.new(0,-90,0)
				if character.Humanoid.RigType == Enum.HumanoidRigType.R15 then
					tpR15:Destroy()
					tpR15 = Instance.new("Part", portal1)
					tpR15.Size = Vector3.new(.7,.7,.7)
					tpR15.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
					tpR15.Anchored = true
					tpR15.CanCollide = false
					tpR15.CanQuery = false
					tpR15.Transparency = 1
					local tween = ts:Create(tpR15,info2,{Size=Vector3.new(5,7,2.5),Transparency=1})
					tween:Play()
				end
				velocheck:Destroy()
				velocheck = Instance.new("Part", portal1)
				velocheck.Transparency = 1
				velocheck.CanCollide = false
				velocheck.CanQuery = false
				velocheck.Anchored = true 
				velocheck.Orientation = Vector3.new(0,0,0)
				velocheck.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				velocheck.Size = Vector3.new(10,16,20)
				portalin1 = Instance.new("Part", portal1)
				portalin1.Size = Vector3.new(.5,.5,.5)
				portalin1.BrickColor = BrickColor.new("Bright blue")
				portalin1.Material = Enum.Material.Neon
				portalin1.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				portalin1.Orientation = Vector3.new(90,0,0)
				portalin1.Anchored = true 
				portalin1.CanCollide = false
				portalmesh1 = Instance.new("SpecialMesh", portalin1)
				portalmesh1.MeshType = "Sphere"
				portalmesh1.Scale = Vector3.new(1.1,6,.05)
				portalmesh1.Offset = Vector3.new(0,0,-0.02)
				portalin1.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				portal1.Size = Vector3.new(.7,.7,.7)
				portal1.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				if portal2 then
					portalin1.BrickColor = BrickColor.new("Really black")
					portalin2.BrickColor = BrickColor.new("Really black")
				else
					portalin1.BrickColor = BrickColor.new("Bright blue")
					portalin1.Material = Enum.Material.Neon
				end
				local velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
				velocheck.Touched:Connect(function(hit)
					velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
					task.wait(0.1)
				end)
				if character.Humanoid.RigType == Enum.HumanoidRigType.R15 then
					tpR15.Touched:Connect(function(hit)
						if hit.Parent == player.Character and portal2 and tpcd == false then	
							tpcd = true
							SoundRNG = math.random(1, 2)
							if SoundRNG == 2 then
								Teleport.SoundId = "rbxassetid://232806289"
							else 
								Teleport.SoundId = "rbxassetid://2769872789"
							end
							Teleport:Play()
							player.Character.HumanoidRootPart.CFrame = TP2.CFrame
							player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal2.CFrame.LookVector*(velocity*2.75)
							workspace.CurrentCamera.CFrame =  portal2.CFrame
							if portalin1.Orientation == Vector3.new(90,90,0) and portalin2.Orientation == Vector3.new(90,90,0) then
								wait(0.2)
								velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
								player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal2.CFrame.LookVector*(velocity*.1)
							end
							wait(0.2)
							tpcd = false
						end
					end)
				else
					portal1.Touched:Connect(function(hit)
						if hit.Parent == player.Character and portal2 and tpcd == false then	
							tpcd = true
							SoundRNG = math.random(1, 2)
							if SoundRNG == 2 then
								Teleport.SoundId = "rbxassetid://232806289"
							else 
								Teleport.SoundId = "rbxassetid://2769872789"
							end
							Teleport:Play()
							player.Character.HumanoidRootPart.CFrame = TP2.CFrame
							player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal2.CFrame.LookVector*(velocity*2.75)
							workspace.CurrentCamera.CFrame =  portal2.CFrame
							if portalin1.Orientation == Vector3.new(90,90,0) and portalin2.Orientation == Vector3.new(90,90,0) then
								wait(0.2)
								velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
								player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal2.CFrame.LookVector*(velocity*.1)
							end
							wait(0.2)
							tpcd = false
						end
					end)
				end
				local tween = ts:Create(portal1,info2,{Size=Vector3.new(5,6,1),Transparency=0})
				tween:Play()
				local tween = ts:Create(portalin1,info2,{Size=Vector3.new(4.1,1.23,2.5),Transparency=0})
				tween:Play()
			end
		elseif ptype == 2 then
			if portal2 == nil then
				portal2 = Instance.new("Part")
				portal2.Name = ("Orange2")
				sp2 = Instance.new("SpecialMesh", portal2)
				sp2.MeshType = "Sphere"
				sp2.Scale = Vector3.new(1,1.33,0.05)
				sp2.Offset = Vector3.new(0,0,-0.02)
				idle2 = Instance.new("Sound", portal2)
				idle2.SoundId = "rbxassetid://148894502"
				idle2.Looped = true
				idle2.Volume = 0.2
				open2 = Instance.new("Sound", portal2)
				open2.SoundId = "rbxassetid://182981587"
				open2.Volume = 0.35
				open2.PlayOnRemove = true 
				soundopen2 = Instance.new("Sound", portal2)
				soundopen2.SoundId = "rbxassetid://171399373"
				soundopen2.RollOffMinDistance = 30
				soundopen2.Pitch = 1.02	
				soundopen2.Volume = 0.6
				soundopen2:Play()
				portal2.Size = Vector3.new(.7,.7,.7)
				portal2.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				portal2.Anchored = true
				portal2.CanCollide = false
				portal2.BrickColor = BrickColor.new("Neon orange")
				portal2.Material = Enum.Material.Neon
				portal2.Parent = workspace
				TP2 = Instance.new("Part", portal2)
				TP2.Transparency = 1
				TP2.CanCollide = false
				TP2.Size = Vector3.new(.5,.5,.5)
				TP2.Anchored = true 
				TP2.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				TP2.Orientation = Vector3.new(0,-90,0)
				if character.Humanoid.RigType == Enum.HumanoidRigType.R15 then
					tp2R15 = Instance.new("Part", portal2)
					tp2R15.Size = Vector3.new(.7,.7,.7)
					tp2R15.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
					tp2R15.Anchored = true
					tp2R15.CanCollide = false
					tp2R15.CanQuery = false
					tp2R15.Transparency = 1
					local tween = ts:Create(tp2R15,info2,{Size=Vector3.new(5,7,2.5),Transparency=1})
					tween:Play()
				end
				velocheck2 = Instance.new("Part", portal2)
				velocheck2.Transparency = 1
				velocheck2.CanCollide = false
				velocheck2.CanQuery = false
				velocheck2.Anchored = true 
				velocheck2.Orientation = Vector3.new(0,0,0)
				velocheck2.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				velocheck2.Size = Vector3.new(10,16,20)
				portalin2 = Instance.new("Part", portal2)
				portalin2.Size = Vector3.new(.5,.5,.5)
				portalin2.CanCollide = false
				portalin2.BrickColor = BrickColor.new("Neon orange")
				portalin2.Material = Enum.Material.Neon
				portalin2.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				portalin2.Orientation = Vector3.new(90,0,0)
				portalin2.Anchored = true 
				portalmesh2 = Instance.new("SpecialMesh", portalin2)
				portalmesh2.MeshType = "Sphere"
				portalmesh2.Scale = Vector3.new(1.1,6,.05)
				portalmesh2.Offset = Vector3.new(0,0,-0.02)
				portalin2.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				ESP2 = Instance.new("Highlight", portal2)
				ESP2.FillTransparency = 1
				ESP2.OutlineColor = Color3.fromRGB(255,225,58)
				if portal1 then
					portalin2.BrickColor = BrickColor.new("Really black")
					portalin1.BrickColor = BrickColor.new("Really black")
					game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683216197"
				else
					portalin2.BrickColor = BrickColor.new("Neon orange")
					portalin2.Material = Enum.Material.Neon
					game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683371140"
				end
				local tween = ts:Create(portalin2,info2,{Size=Vector3.new(4.1,1.23,2.5),Transparency=0})
				tween:Play()
				local tween = ts:Create(portal2,info2,{Size=Vector3.new(5,6,1),Transparency=0})
				tween:Play()
				idle2:Play()
				local velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
				velocheck2.Touched:Connect(function(hit)
					velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude	
					task.wait(0.1)
				end)
				if character.Humanoid.RigType == Enum.HumanoidRigType.R15 then
					tp2R15.Touched:Connect(function(hit)
						if hit.Parent == player.Character and portal2 and tpcd == false then	
							tpcd = true
							SoundRNG = math.random(1, 2)
							if SoundRNG == 2 then
								Teleport.SoundId = "rbxassetid://232806289"
							else 
								Teleport.SoundId = "rbxassetid://2769872789"
							end
							Teleport:Play()
							player.Character.HumanoidRootPart.CFrame = TP1.CFrame
							player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal1.CFrame.LookVector*(velocity*2.75)
							workspace.CurrentCamera.CFrame =  portal1.CFrame
							if portalin1.Orientation == Vector3.new(90,90,0) and portalin2.Orientation == Vector3.new(90,90,0) then
								wait(0.2)
								velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
								player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal1.CFrame.LookVector*(velocity*.1)
							end
							wait(0.2)
							tpcd = false
						end
					end)
				else
					portal2.Touched:Connect(function(hit)
						if hit.Parent == player.Character and portal2 and tpcd == false then	
							tpcd = true
							SoundRNG = math.random(1, 2)
							if SoundRNG == 2 then
								Teleport.SoundId = "rbxassetid://232806289"
							else 
								Teleport.SoundId = "rbxassetid://2769872789"
							end
							Teleport:Play()
							player.Character.HumanoidRootPart.CFrame = TP1.CFrame
							player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal1.CFrame.LookVector*(velocity*2.75)
							workspace.CurrentCamera.CFrame =  portal1.CFrame
							if portalin1.Orientation == Vector3.new(90,90,0) and portalin2.Orientation == Vector3.new(90,90,0) then
								wait(0.2)
								velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
								player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal1.CFrame.LookVector*(velocity*.1)
							end
							wait(0.2)
							tpcd = false
						end
					end)
				end
			else
				open2:Destroy()
				open2 = Instance.new("Sound", portal2)
				open2.SoundId = "rbxassetid://182981587"
				open2.Volume = 0.35
				open2.PlayOnRemove = true 
				soundopen2:Play()
				portal2.Size = Vector3.new(.7,.7,.7)
				portal2.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				TP2:Destroy()
				TP2 = Instance.new("Part", portal2)
				TP2.Transparency = 1
				TP2.CanCollide = false
				TP2.Size = Vector3.new(.5,.5,.5)
				TP2.Anchored = true 
				TP2.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				TP2.Orientation= Vector3.new(0,-90,0)
				if character.Humanoid.RigType == Enum.HumanoidRigType.R15 then
					tp2R15:Destroy()
					tp2R15 = Instance.new("Part", portal2)
					tp2R15.Size = Vector3.new(.7,.7,.7)
					tp2R15.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
					tp2R15.Anchored = true
					tp2R15.CanCollide = false
					tp2R15.CanQuery = false
					tp2R15.Transparency = 1
					local tween = ts:Create(tp2R15,info2,{Size=Vector3.new(5,7,2.5),Transparency=1})
					tween:Play()
				end
				velocheck2:Destroy()
				velocheck2 = Instance.new("Part", portal2)
				velocheck2.Transparency = 1
				velocheck2.CanCollide = false
				velocheck2.CanQuery = false
				velocheck2.Anchored = true 
				velocheck2.Orientation = Vector3.new(0,0,0)
				velocheck2.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				velocheck2.Size = Vector3.new(10,16,20)
				portalin2:Destroy()
				portalin2 = Instance.new("Part", portal2)
				portalin2.Size = Vector3.new(.5,.5,.5)
				portalin2.CanCollide = false
				portalin2.BrickColor = BrickColor.new("Neon orange")
				portalin2.Material = Enum.Material.Neon
				portalin2.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				portalin2.Orientation = Vector3.new(90,0,0)
				portalin2.Anchored = true 
				portalmesh2 = Instance.new("SpecialMesh", portalin2)
				portalmesh2.MeshType = "Sphere"
				portalmesh2.Scale = Vector3.new(1.1,6,.05)
				portalmesh2.Offset = Vector3.new(0,0,-0.02)
				portalin2.CFrame = CFrame.lookAt(rpos,rpos+rnorm)
				local velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
				velocheck2.Touched:Connect(function(hit)
					velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
					task.wait(0.1)
				end)
				if character.Humanoid.RigType == Enum.HumanoidRigType.R15 then
					tp2R15.Touched:Connect(function(hit)
						if hit.Parent == player.Character and portal2 and tpcd == false then	
							tpcd = true
							SoundRNG = math.random(1, 2)
							if SoundRNG == 2 then
								Teleport.SoundId = "rbxassetid://232806289"
							else 
								Teleport.SoundId = "rbxassetid://2769872789"
							end
							Teleport:Play()
							player.Character.HumanoidRootPart.CFrame = TP1.CFrame
							player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal1.CFrame.LookVector*(velocity*2.75)
							workspace.CurrentCamera.CFrame =  portal1.CFrame
							if portalin1.Orientation == Vector3.new(90,90,0) and portalin2.Orientation == Vector3.new(90,90,0) then
								wait(0.2)
								velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
								player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal1.CFrame.LookVector*(velocity*.1)
							end
							wait(0.2)
							tpcd = false
						end
					end)
				else
					portal2.Touched:Connect(function(hit)
						if hit.Parent == player.Character and portal2 and tpcd == false then	
							tpcd = true
							SoundRNG = math.random(1, 2)
							if SoundRNG == 2 then
								Teleport.SoundId = "rbxassetid://232806289"
							else 
								Teleport.SoundId = "rbxassetid://2769872789"
							end
							Teleport:Play()
							player.Character.HumanoidRootPart.CFrame = TP1.CFrame
							player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal1.CFrame.LookVector*(velocity*2.75)
							workspace.CurrentCamera.CFrame =  portal1.CFrame
							if portalin1.Orientation == Vector3.new(90,90,0) and portalin2.Orientation == Vector3.new(90,90,0) then
								wait(0.2)
								velocity = player.Character.HumanoidRootPart.AssemblyLinearVelocity.Magnitude
								player.Character.HumanoidRootPart.AssemblyLinearVelocity = portal1.CFrame.LookVector*(velocity*.1)
							end
							wait(0.2)
							tpcd = false
						end
					end)
				end
				if portal1 then
					portalin2.BrickColor = BrickColor.new("Really black")
					portalin1.BrickColor = BrickColor.new("Really black")
				else
					portalin2.BrickColor = BrickColor.new("Neon orange")
					portalin2.Material = Enum.Material.Neon
				end
				local tween = ts:Create(portalin2,info2,{Size=Vector3.new(4.1,1.23,2.5),Transparency=0})
				tween:Play()
				local tween = ts:Create(portal2,info2,{Size=Vector3.new(5,6,1),Transparency=0})
				tween:Play()
			end
		end
	end
end
-- Character
player.CharacterAdded:Connect(function(char)
	if portal1 then
		portal1:Destroy()
		portalin1:Destroy()
	end
	if portal2 then
		portal2:Destroy()
		portalin2:Destroy()
	end
	portal1 = nil
	portal2 = nil
	tpcd = false
	toolequipped = false
	GrabObject = nil --stop grab
	isHolding = false
	GrabStart = false
	if Dragger then
		Dragger:Destroy()
		Dragger = nil
	end
	local Humanoid = game.Players.LocalPlayer.Character:WaitForChild("Humanoid")
	-- Create tool
	local tool = Instance.new("Tool")
	tool.CanBeDropped = false
	local handle = Instance.new("Part", tool)
	handle.Name = "Handle"
	handle.CanCollide = false
	handle.CanQuery = false
	handle.Transparency = 1
	handle.Size = Vector3.new(0.85, 0.55, 2)
	local part1 = Instance.new("Part")
	part1.CanCollide = false
	part1.CanQuery = false 
	part1.Parent = handle
	part1.Shape = "Cylinder"
	part1.Material = Enum.Material.SmoothPlastic
	part1.Color = Color3.fromRGB(202,203,209)
	part1.Size = Vector3.new(0.85, 0.55, 2)
	part1.Position = Vector3.new(0,-0.1,0.55)
	part1.Orientation = Vector3.new(0,90,180)
	local skibidi = Instance.new("Decal", part1)
	skibidi.Face = "Top"
	skibidi.Texture = "http://www.roblox.com/asset/?id=17296547954"
	local part2 = Instance.new("Part")
	part2.CanCollide = false
	part2.CanQuery = false 
	part2.Parent = handle
	part2.Shape = "Cylinder"
	part2.Material = Enum.Material.SmoothPlastic
	part2.Color = Color3.fromRGB(202,203,209)
	part2.Size = Vector3.new(0.5, 0.55, 0.42)
	part2.Position = Vector3.new(-0, -0.1, 0.275)
	part2.Orientation = Vector3.new(0,90,180)
	local part3 = Instance.new("Part")
	part3.CanCollide = false
	part3.CanQuery = false 
	part3.Parent = handle
	part3.Material = Enum.Material.SmoothPlastic
	part3.Color = Color3.fromRGB(202,203,209)
	part3.Size = Vector3.new(0.051, 0.4, 0.7)
	part3.Position = Vector3.new(-0.001, -0.1, -0.2)
	part3.Orientation = Vector3.new(0, 0, -90)
	local part4 = Instance.new("Part")
	part4.CanCollide = false
	part4.CanQuery = false 
	part4.Parent = handle
	part4.Material = Enum.Material.SmoothPlastic
	part4.Color = Color3.fromRGB(202,203,209)
	part4.Size = Vector3.new(0.051, 0.4, 0.7)
	part4.Position = Vector3.new(-0.001, -0.1, -0.2)
	part4.Orientation = Vector3.new(0, 0, 0)
	local part5 = Instance.new("Part")
	part5.CanCollide = false
	part5.CanQuery = false 
	part5.Parent = handle
	part5.Material = Enum.Material.Fabric
	part5.Color = Color3.fromRGB(160, 95, 53)
	part5.Size = Vector3.new(0.2, 0.286, 0.055)
	part5.Position = Vector3.new(0.003, 0.09,0.4)
	part5.Orientation = Vector3.new(0, 0, 0)
	local part6 = Instance.new("Part")
	part6.CanCollide = false
	part6.CanQuery = false 
	part6.Parent = handle
	part6.Material = Enum.Material.SmoothPlastic
	part6.Color = Color3.fromRGB(202,203,209)
	part6.Size = Vector3.new(0.218, 0.055, 0.109)
	part6.Position = Vector3.new(0.001, 0.229, 0.36)
	part6.Orientation = Vector3.new(0, 90, 0)
	local sight = Instance.new("SpecialMesh", part6)
	sight.MeshId = "rbxassetid://9494628839"
	sight.Scale = Vector3.new(0.012, 0.012, 0.012)
	local part7 = Instance.new("Part")
	part7.CanCollide = false
	part7.CanQuery = false 
	part7.Parent = handle
	part7.Material = Enum.Material.SmoothPlastic
	part7.Color = Color3.fromRGB(202,203,209)
	part7.Size = Vector3.new(0.25, 0.4, 0.45)
	part7.Position = Vector3.new(0.004, -0.1, 1)
	part7.Orientation = Vector3.new(0, 0, -90)
	local grip = Instance.new("SpecialMesh", part7)
	grip.MeshId = "rbxassetid://11465380951"
	grip.Scale = Vector3.new(0.011, 0.011, 0.011)
	local part8 = Instance.new("Part")
	part8.CanCollide = false
	part8.CanQuery = false 
	part8.Parent = handle
	part8.Material = Enum.Material.SmoothPlastic
	part8.Color = Color3.fromRGB(202,203,209)
	part8.Size = Vector3.new(0.3, 0.075, 0.15)
	part8.Position = Vector3.new(0.001, -0.436, -0.584)
	part8.Orientation = Vector3.new(0, -90, 0)
	local part9 = Instance.new("Part")
	part9.CanCollide = false
	part9.CanQuery = false 
	part9.Parent = handle
	part9.Shape = "Cylinder"
	part9.Material = Enum.Material.Fabric
	part9.Color = Color3.fromRGB(160, 95, 53)
	part9.Size = Vector3.new(0.061, 0.152, 2)
	part9.Position = Vector3.new(0.002, -0.437, -0.624)
	part9.Orientation = Vector3.new(0,90,180)
	local part10 = Instance.new("Part") 
	part10.CanCollide = false
	part10.CanQuery = false 
	part10.Parent = handle
	part10.Shape = "Cylinder"
	part10.Material = Enum.Material.SmoothPlastic
	part10.Color = Color3.fromRGB(202,203,209)
	part10.Size = Vector3.new(0.5, 0.55, 0.4)
	part10.Position = Vector3.new(-0, -0.1, -0.625)
	part10.Orientation = Vector3.new(0,90,180)
	local part11 = Instance.new("Part") 
	part11.CanCollide = false 
	part11.CanQuery = false 
	part11.Parent = handle
	part11.Shape = "Cylinder"
	part11.Material = Enum.Material.SmoothPlastic
	part11.Color = Color3.fromRGB(202,203,209)
	part11.Size = Vector3.new(0.3, 0.55, 2)
	part11.Position = Vector3.new(-0, -0.1, -0.625)
	part11.Orientation = Vector3.new(0,90,180)
	local part12 = Instance.new("Part") 
	part12.CanCollide = false 
	part12.CanQuery = false 
	part12.Parent = handle
	part12.Shape = "Cylinder"
	part12.Material = Enum.Material.SmoothPlastic
	part12.Color = Color3.fromRGB(202,203,209)
	part12.Size = Vector3.new(0.95, 0.05, 2)
	part12.Position = Vector3.new(-0, -0.1, -0.625)
	part12.Orientation = Vector3.new(45, 90, 90)
	local part13 = Instance.new("Part") 
	part13.CanCollide = false 
	part13.CanQuery = false 
	part13.Parent = handle
	part13.Shape = "Cylinder"
	part13.Material = Enum.Material.SmoothPlastic
	part13.Color = Color3.fromRGB(202,203,209)
	part13.Size = Vector3.new(0.95, 0.05, 2)
	part13.Position = Vector3.new(-0, -0.1, -0.625)
	part13.Orientation = Vector3.new(45,-90, -90)
	local part14 = Instance.new("Part") 
	part14.CanCollide = false 
	part14.CanQuery = false 
	part14.Parent = handle
	part14.Shape = "Cylinder"
	part14.Material = Enum.Material.SmoothPlastic
	part14.Color = Color3.fromRGB(202,203,209)
	part14.Size = Vector3.new(0.45, 0.05, 2)
	part14.Position = Vector3.new(-0.282, 0.182, -0.818)
	part14.Orientation = Vector3.new(-45, 90, -15)
	local part15 = Instance.new("Part") 
	part15.CanCollide = false 
	part15.CanQuery = false 
	part15.Parent = handle
	part15.Shape = "Cylinder"
	part15.Material = Enum.Material.SmoothPlastic
	part15.Color = Color3.fromRGB(202,203,209)
	part15.Size = Vector3.new(0.45, 0.05, 2)
	part15.Position = Vector3.new(0.277, 0.177, -0.817)
	part15.Orientation = Vector3.new(45, 90, -15)
	local part16 = Instance.new("Part") 
	part16.CanCollide = false 
	part16.CanQuery = false 
	part16.Parent = handle
	part16.Shape = "Cylinder"
	part16.Material = Enum.Material.SmoothPlastic
	part16.Color = Color3.fromRGB(202,203,209)
	part16.Size = Vector3.new(0.45, 0.05, 2)
	part16.Position = Vector3.new(-0.277, -0.377, -0.817)
	part16.Orientation = Vector3.new(45, 90, 15)
	local part17 = Instance.new("Part") 
	part17.CanCollide = false 
	part17.CanQuery = false 
	part17.Parent = handle
	part17.Shape = "Cylinder"
	part17.Material = Enum.Material.SmoothPlastic
	part17.Color = Color3.fromRGB(202,203,209)
	part17.Size = Vector3.new(0.45, 0.05, 2)
	part17.Position = Vector3.new(0.282, -0.382, -0.818)
	part17.Orientation = Vector3.new(-45, 90, 15)
	local part18 = Instance.new("Part") 
	part18.CanCollide = false 
	part18.CanQuery = false 
	part18.Parent = handle
	part18.Material = Enum.Material.SmoothPlastic
	part18.Color = Color3.fromRGB(202,203,209)
	part18.Size = Vector3.new(0.03, 0.327, 0.036)
	part18.Position = Vector3.new(0.009, 0.152, -0.755)	
	local flashlightBase = Instance.new("SpecialMesh", part8) 
	flashlightBase.MeshId = "rbxassetid://6300528939"
	flashlightBase.Scale = Vector3.new(0.012, 0.012, 0.012)
	local cylinder1  = Instance.new("Part", handle)
	cylinder1.Shape = "Cylinder" --Blue Cylinder
	cylinder1.Orientation = Vector3.new(0,90,180)
	cylinder1.Position = Vector3.new(-0, -0.1, -0.25)
	cylinder1.Size = Vector3.new(1.255,0.35, 2)
	cylinder1.Material = Enum.Material.Glass
	cylinder1.Color = Color3.fromRGB(17,17,17)
	cylinder1.CanCollide = false -- Cylinder
	cylinder1.CanQuery = false
	local flashlightcircle  = Instance.new("Part", handle) --cylinder2
	flashlightcircle.Shape = Enum.PartType.Ball 
	flashlightcircle.Position = Vector3.new(0, -0.431, -0.865)
	flashlightcircle.Orientation = Vector3.new(0, 90, 180)
	flashlightcircle.Size = Vector3.new(0.001, 0.207, 0.22)
	flashlightcircle.Material = Enum.Material.Glass
	flashlightcircle.BrickColor = BrickColor.new("Really black")
	flashlightcircle.CanCollide = false
	flashlightcircle.CanQuery = false
	local GGball = Instance.new("Part", handle) -- GG Field
	GGball.Shape = Enum.PartType.Ball 
	GGball.CanCollide = false 
	GGball.CanQuery = false
	GGball.BrickColor = BrickColor.new("Pastel Blue")
	GGball.Transparency = 1
	GGball.Material = Enum.Material.Neon
	GGball.Position = Vector3.new(0.002, -0.1, -1.2)
	GGball.Size = Vector3.new(0.29,0.29,0.29)
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = GGball
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = cylinder1
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = flashlightcircle
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part1
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part2
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part3
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part4
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part5
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part6
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part7
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part8
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part9
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part10
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part11
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part12
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part13
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part14
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part15
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part16
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part17
	local weld = Instance.new("WeldConstraint", tool) --Welds
	weld.Part0 = handle
	weld.Part1 = part18
	BShoot = Instance.new("Sound", handle)
	BShoot.SoundId = "rbxassetid://182981554"
	OShoot = Instance.new("Sound", handle)
	OShoot.SoundId = "rbxassetid://142774034"
	local gravitygun = Instance.new("Sound", handle)
	gravitygun.Looped = true
	gravitygun.SoundId = "rbxassetid://7449423195"
	tool.Name = "Budget Portal Gun 2.0"
	tool.ToolTip = "i promise its not made with plastic this time"
	if char.Humanoid.RigType == Enum.HumanoidRigType.R6 then
		if VRService.VREnabled then 
			tool.GripPos = Vector3.new(0,-0.5,0)
		else
			tool.GripPos = Vector3.new(0.35,0.1,0.25)
		end
	else
		if VRService.VREnabled then 
			tool.GripPos = Vector3.new(0,-0.5,0)
		else
			tool.GripPos = Vector3.new(0.2,-0.2,-0.1)
		end
	end
	tool.Parent = player.Backpack
	local light = Instance.new("SpotLight", flashlightcircle)
	light.Face = "Left"
	light.Angle = 45
	light.Brightness = 2
	light.Range = 60
	light.Enabled = false
	local click = Instance.new("Sound", handle)
	click.SoundId = "rbxassetid://5991592592"
	mouse.KeyDown:Connect(function(key)
		if key == "f" then 
			if tool.parent == char and toolequipped == true and isHolding == false then
				click:Play()
				if light.Enabled == false then
					light.Enabled = true
					flashlightcircle.Material = Enum.Material.Neon
					flashlightcircle.BrickColor = BrickColor.new("White")
				else
					light.Enabled = false
					flashlightcircle.Material = Enum.Material.Glass
					flashlightcircle.BrickColor = BrickColor.new("Really black")
				end
			end
		end
	end)
	UserInputService.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.Gamepad1 then
			if input.KeyCode == Enum.KeyCode.ButtonL2 then
				if tool.parent == char and toolequipped == true and isHolding == false then
					click:Play()
					if light.Enabled == false then
						light.Enabled = true
						flashlightcircle.Material = Enum.Material.Neon
						flashlightcircle.BrickColor = BrickColor.new("White")
					else
						light.Enabled = false
						flashlightcircle.Material = Enum.Material.Glass
						flashlightcircle.BrickColor = BrickColor.new("Really black")
					end
				end
			end
		end
	end)	
	tool.Equipped:Connect(function(mouse)
		toolequipped = true
		if portal1 then
			game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683350503"
		end 
		if portal2 then
			game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683371140"
		end 
		if portal1 and portal2 then 
			game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683216197"
		end 
		if portal1 == nil and portal2 == nil then 
			game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683282532"
		end
		if isHolding == true then
			game.Players.LocalPlayer:GetMouse().Icon = ""
		end
	end)
	tool.Unequipped:Connect(function(mouse)
		game.Players.LocalPlayer:GetMouse().Icon = ""
		toolequipped = false 
		GrabObject = nil --stop grab
		isHolding = false
		GrabStart = false
		if Dragger then
			Dragger:Destroy()
			Dragger = nil
		end
		gravitygun:Stop()
		GGball.Transparency = 1
	end)
	-- Activate
	mouse.Button1Down:Connect(function()
		if tool.Parent == char and toolequipped == true and isHolding == false then
			BShoot:Play()
			createportal(cylinder1.CFrame*CFrame.new(0,0,-2.7).Position,mouse.Hit.Position,mouse.Target,1)
			cylinder1.BrickColor = BrickColor.new("Bright blue")
			cylinder1.Material = Enum.Material.Neon
		end
	end)
	UserInputService.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.Gamepad1 then
			if input.KeyCode == Enum.KeyCode.ButtonB then
				if tool.Parent == char and toolequipped == true and isHolding == false then
					OShoot:Play()
					createportal(cylinder1.CFrame*CFrame.new(0,0,-2.7).Position,mouse.Hit.Position,mouse.Target,2)
					cylinder1.BrickColor = BrickColor.new("Neon orange")
					cylinder1.Material = Enum.Material.Neon
				end
			end
		end
	end)
	mouse.Button2Down:Connect(function()
		if tool.Parent == char and toolequipped == true and isHolding == false then
			OShoot:Play()
			createportal(cylinder1.CFrame*CFrame.new(0,0,-2.7).Position,mouse.Hit.Position,mouse.Target,2)
			cylinder1.BrickColor = BrickColor.new("Neon orange")
			cylinder1.Material = Enum.Material.Neon
		end
	end)
	char.Humanoid.Died:Connect(function()
		if tool then	
			tool:Destroy()
		end
		if portal1 then
			portal1:Destroy()
		end
		if portal2 then
			portal2:Destroy()
		end
		if portalin1 then
			portalin1:Destroy()
		end
		if portalin2 then
			portalin2:Destroy()
		end
		GrabObject = nil --stop grab
		isHolding = false
		GrabStart = false
		if Dragger then
			Dragger:Destroy()
			Dragger = nil
		end
	end)
	--Reseting Portals
	mouse.KeyDown:Connect(function(key)
		if key == "r" then 
			if tool.parent == char and toolequipped == true and isHolding == false then
				if portal1 then
					portal1:Destroy()
					portalin1:Destroy()
				end
				if portal2 then
					portal2:Destroy()
					portalin2:Destroy()
				end
				portal1 = nil
				portal2 = nil
				tpcd = false
				cylinder1.Material = Enum.Material.Glass
				cylinder1.Color = Color3.fromRGB(17,17,17)
				if portal1 == nil and portal2 == nil then 
					game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683282532"
				end
			end
		end
	end)
	UserInputService.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.Gamepad1 then
			if input.KeyCode == Enum.KeyCode.ButtonX then
				if tool.parent == char and toolequipped == true and isHolding == false then
					if portal1 then
						portal1:Destroy()	
						portalin1:Destroy()
					end
					if portal2 then
						portal2:Destroy()
						portalin2:Destroy()
					end
					portal1 = nil
					portal2 = nil
					tpcd = false
					cylinder1.Material = Enum.Material.Glass
					cylinder1.Color = Color3.fromRGB(17, 17, 17)
					if portal1 == nil and portal2 == nil then 
						game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683282532"
					end
				end
			end
		end
	end)
	--Gravity Gun
	UserInputService.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.Gamepad1 then
			if input.KeyCode == Enum.KeyCode.ButtonY then
				if tool.parent == char and toolequipped == true then
					if isHolding == false then 
						--start grab
						local Magnitude = (mouse.Hit.Position - char.Head.CFrame.Position).magnitude
						if Magnitude < 10 then

							if not mouse.Target.Anchored then
								GrabObject = mouse.Target
								GrabStart = true
								isHolding = true	
								gravitygun:Play()
								GGball.Transparency = 0
								game.Players.LocalPlayer:GetMouse().Icon = ""

								local DragBall = createDragBall()
								DragBall.CFrame = mouse.hit
								Dragger = DragBall

								mouse.TargetFilter = GrabObject

								local DragBallWeld = weldBetween(DragBall,GrabObject)
								addMover(DragBall)

								while Dragger do
									--Create a ray from the users head to the mouse
									local cf = CFrame.new(char.Head.Position, mouse.Hit.Position)
									Dragger.Mover.Position = (cf + (cf.LookVector * 10)).Position
									Dragger.RotMover.CFrame = camera.CFrame * CFrame.Angles(Dragger.RotOffset.Value.X,Dragger.RotOffset.Value.Y, Dragger.RotOffset.Value.Z)
									wait()
								end
								mouse.TargetFilter = nil
							end
						end
					else
						GrabObject = nil --stop grab
						isHolding = false
						GrabStart = false
						gravitygun:Stop()
						if Dragger then
							Dragger:Destroy()
							Dragger = nil
						end
						GGball.Transparency = 1
						if portal1 then
							game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683350503"
						end 
						if portal2 then
							game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683371140"
						end 
						if portal1 and portal2 then 
							game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683216197"
						end 
						if portal1 == nil and portal2 == nil then 
							game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683282532"
						end
					end
				end
			end
		end
	end)
	mouse.KeyDown:Connect(function(key)
		if key == "e" then 
			if tool.parent == char and toolequipped == true then
				if isHolding == false then 
					--start grab
					local Magnitude = (mouse.Hit.Position - char.Head.CFrame.Position).magnitude
					if Magnitude < 10 then

						if not mouse.Target.Anchored then
							GrabObject = mouse.Target
							GrabStart = true
							isHolding = true	
							gravitygun:Play()
							GGball.Transparency = 0
							game.Players.LocalPlayer:GetMouse().Icon = ""

							local DragBall = createDragBall()
							DragBall.CFrame = mouse.hit
							Dragger = DragBall

							mouse.TargetFilter = GrabObject

							local DragBallWeld = weldBetween(DragBall,GrabObject)
							addMover(DragBall)

							while Dragger do
								--Create a ray from the users head to the mouse
								local cf = CFrame.new(char.Head.Position, mouse.Hit.Position)
								Dragger.Mover.Position = (cf + (cf.LookVector * 10)).Position
								Dragger.RotMover.CFrame = camera.CFrame * CFrame.Angles(Dragger.RotOffset.Value.X,Dragger.RotOffset.Value.Y, Dragger.RotOffset.Value.Z)
								wait()
							end
							mouse.TargetFilter = nil
						end
					end
				else
					GrabObject = nil --stop grab
					isHolding = false
					GrabStart = false
					gravitygun:Stop()
					if Dragger then
						Dragger:Destroy()
						Dragger = nil
					end
					GGball.Transparency = 1
					if portal1 then
						game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683350503"
					end 
					if portal2 then
						game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683371140"
					end 
					if portal1 and portal2 then 
						game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683216197"
					end 
					if portal1 == nil and portal2 == nil then 
						game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683282532"
					end
				end
			end
		end
	end)


	function weldBetween(a, b)
		local weld = Instance.new("ManualWeld", a)
		weld.C0 = a.CFrame:inverse() * b.CFrame
		weld.Part0 = a
		weld.Part1 = b
		return weld
	end


	function addMover(part)
		local newMover = Instance.new("BodyPosition")
		newMover.Parent = part
		newMover.MaxForce = Vector3.new(40000,40000,40000)
		newMover.P = 40000
		newMover.D = 1000
		newMover.Position = part.Position
		newMover.Name = "Mover"

		local newRot = Instance.new("BodyGyro")
		newRot.Parent = part
		newRot.MaxTorque = Vector3.new(3000,3000,3000)
		newRot.P = 3000
		newRot.D = 500
		newRot.CFrame = game.Workspace.CurrentCamera.CFrame
		newRot.Name ="RotMover"

		local RotOffset = Instance.new("CFrameValue")
		RotOffset.Name = "RotOffset"
		RotOffset.Parent = part
	end


	function createDragBall()
		local DragBall = Instance.new("Part")
		DragBall.Transparency = 1
		DragBall.CanCollide = false
		DragBall.Size = Vector3.new(.2,.2,.2)
		DragBall.Shape = "Ball"
		DragBall.Name = "DragBall"
		DragBall.Parent = workspace
		return DragBall
	end
	--Arm Animation
	if char.Humanoid.RigType == Enum.HumanoidRigType.R15 then
		--- Services ---
		local Players = game:GetService("Players");
		local RunService = game:GetService("RunService");
		wait();

		--- Declarations ---
		local Player = Players.LocalPlayer;
		local Character = Player.Character or Player.CharacterAdded:Wait();

		local Mouse = Player:GetMouse();

		--- Character ---
		local RightUpperArm = Character:WaitForChild("RightUpperArm");
		local RightShoulder = RightUpperArm:WaitForChild("RightShoulder");
		local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart");

		--- Execution ---
		RunService.Stepped:Connect(function()
			if toolequipped == true then
				local hit = Mouse.Hit;

				-- add the lookVector * 5000 to the hit.p to make the point more "dramatic" (remove it and you'll see why I did this)
				local direction = (hit.lookVector * 5000);

				-- get the rotation offset (so the arm points correctly depending on your rotation)
				local rootCFrame = HumanoidRootPart.CFrame;
				local rotationOffset = (rootCFrame - rootCFrame.p):inverse();

				-- since CFrames are relative, put the rotationOffset first, and then multiple by the point CFrame, and then multiple by the CFrame.Angles so the arm points in the right direction
				RightShoulder.Transform = rotationOffset * CFrame.new(Vector3.new(0, 0, 0), direction) * CFrame.Angles(math.pi / 2, 0, 0);
			end
		end)
	else
		plr = game.Players.LocalPlayer;
		repeat
			wait()
		until plr.Character
		char = plr.Character
		m = plr:GetMouse()


		local origRightS = char:WaitForChild("Torso"):WaitForChild("Right Shoulder").C0
		local origLeftS = char:WaitForChild("Torso"):WaitForChild("Left Shoulder").C0
		local origNeck = char:WaitForChild("Torso"):WaitForChild("Neck").C0
		local camera = game.Workspace.CurrentCamera

		local UIS = game:GetService("UserInputService")

		local c = game.Workspace.CurrentCamera

		game:GetService("RunService").RenderStepped:Connect(function(delta)




			if toolequipped == true then

				if char.Torso:FindFirstChild("Right Shoulder") then
					char.Torso["Right Shoulder"].C0 = char.Torso["Right Shoulder"].C0:Lerp(CFrame.new(1, .65, 0) * CFrame.Angles(-math.asin((m.Origin.p - m.Hit.p).unit.y), 1.55, 0, 0) , 0.1)
				end
				if char.Torso:FindFirstChild("Left Shoulder") then
					char.Torso["Left Shoulder"].C0 = char.Torso["Left Shoulder"].C0:Lerp(CFrame.new(-1, .65, 0) * CFrame.Angles(-math.asin((m.Origin.p - m.Hit.p).unit.y), -1.55, 0, 0) , 0.1)
				end
				if char.Torso:FindFirstChild("Neck") then
					char.Torso["Neck"].C0 = char.Torso["Neck"].C0:Lerp(CFrame.new(0, 1, 0) * CFrame.Angles(-math.asin((m.Origin.p - m.Hit.p).unit.y) + 1.55, 3.15, 0), 0.2)
				end

			else

				if char.Torso:FindFirstChild("Right Shoulder") then
					char.Torso["Right Shoulder"].C0 = char.Torso["Right Shoulder"].C0:lerp(origRightS, 0.1)
				end


				if char.Torso:FindFirstChild("Left Shoulder") then
					char.Torso["Left Shoulder"].C0 = char.Torso["Left Shoulder"].C0:lerp(origLeftS, 0.1)
				end



				if char.Torso:FindFirstChild("Neck") then
					char.Torso["Neck"].C0 = char.Torso["Neck"].C0:lerp(origNeck, 0.1)
				end
			end
		end)
	end
end)	
--GiveToolOnExecution
local tool = Instance.new("Tool")
tool.CanBeDropped = false
local handle = Instance.new("Part", tool)
handle.Name = "Handle"
handle.CanCollide = false
handle.CanQuery = false
handle.Transparency = 1
handle.Size = Vector3.new(0.85, 0.55, 2)
local part1 = Instance.new("Part")
part1.CanCollide = false
part1.CanQuery = false 
part1.Parent = handle
part1.Shape = "Cylinder"
part1.Material = Enum.Material.SmoothPlastic
part1.Color = Color3.fromRGB(202,203,209)
part1.Size = Vector3.new(0.85, 0.55, 2)
part1.Position = Vector3.new(0,-0.1,0.55)
part1.Orientation = Vector3.new(0,90,180)
local skibidi = Instance.new("Decal", part1)
skibidi.Face = "Top"
skibidi.Texture = "http://www.roblox.com/asset/?id=17296547954"
local part2 = Instance.new("Part")
part2.CanCollide = false
part2.CanQuery = false 
part2.Parent = handle
part2.Shape = "Cylinder"
part2.Material = Enum.Material.SmoothPlastic
part2.Color = Color3.fromRGB(202,203,209)
part2.Size = Vector3.new(0.5, 0.55, 0.42)
part2.Position = Vector3.new(-0, -0.1, 0.275)
part2.Orientation = Vector3.new(0,90,180)
local part3 = Instance.new("Part")
part3.CanCollide = false
part3.CanQuery = false 
part3.Parent = handle
part3.Material = Enum.Material.SmoothPlastic
part3.Color = Color3.fromRGB(202,203,209)
part3.Size = Vector3.new(0.051, 0.4, 0.7)
part3.Position = Vector3.new(-0.001, -0.1, -0.2)
part3.Orientation = Vector3.new(0, 0, -90)
local part4 = Instance.new("Part")
part4.CanCollide = false
part4.CanQuery = false 
part4.Parent = handle
part4.Material = Enum.Material.SmoothPlastic
part4.Color = Color3.fromRGB(202,203,209)
part4.Size = Vector3.new(0.051, 0.4, 0.7)
part4.Position = Vector3.new(-0.001, -0.1, -0.2)
part4.Orientation = Vector3.new(0, 0, 0)
local part5 = Instance.new("Part")
part5.CanCollide = false
part5.CanQuery = false 
part5.Parent = handle
part5.Material = Enum.Material.Fabric
part5.Color = Color3.fromRGB(160, 95, 53)
part5.Size = Vector3.new(0.2, 0.286, 0.055)
part5.Position = Vector3.new(0.003, 0.09,0.4)
part5.Orientation = Vector3.new(0, 0, 0)
local part6 = Instance.new("Part")
part6.CanCollide = false
part6.CanQuery = false 
part6.Parent = handle
part6.Material = Enum.Material.SmoothPlastic
part6.Color = Color3.fromRGB(202,203,209)
part6.Size = Vector3.new(0.218, 0.055, 0.109)
part6.Position = Vector3.new(0.001, 0.229, 0.36)
part6.Orientation = Vector3.new(0, 90, 0)
local sight = Instance.new("SpecialMesh", part6)
sight.MeshId = "rbxassetid://9494628839"
sight.Scale = Vector3.new(0.012, 0.012, 0.012)
local part7 = Instance.new("Part")
part7.CanCollide = false
part7.CanQuery = false 
part7.Parent = handle
part7.Material = Enum.Material.SmoothPlastic
part7.Color = Color3.fromRGB(202,203,209)
part7.Size = Vector3.new(0.25, 0.4, 0.45)
part7.Position = Vector3.new(0.004, -0.1, 1)
part7.Orientation = Vector3.new(0, 0, -90)
local grip = Instance.new("SpecialMesh", part7)
grip.MeshId = "rbxassetid://11465380951"
grip.Scale = Vector3.new(0.011, 0.011, 0.011)
local part8 = Instance.new("Part")
part8.CanCollide = false
part8.CanQuery = false 
part8.Parent = handle
part8.Material = Enum.Material.SmoothPlastic
part8.Color = Color3.fromRGB(202,203,209)
part8.Size = Vector3.new(0.3, 0.075, 0.15)
part8.Position = Vector3.new(0.001, -0.436, -0.584)
part8.Orientation = Vector3.new(0, -90, 0)
local part9 = Instance.new("Part")
part9.CanCollide = false
part9.CanQuery = false 
part9.Parent = handle
part9.Shape = "Cylinder"
part9.Material = Enum.Material.Fabric
part9.Color = Color3.fromRGB(160, 95, 53)
part9.Size = Vector3.new(0.061, 0.152, 2)
part9.Position = Vector3.new(0.002, -0.437, -0.624)
part9.Orientation = Vector3.new(0,90,180)
local part10 = Instance.new("Part") 
part10.CanCollide = false
part10.CanQuery = false 
part10.Parent = handle
part10.Shape = "Cylinder"
part10.Material = Enum.Material.SmoothPlastic
part10.Color = Color3.fromRGB(202,203,209)
part10.Size = Vector3.new(0.5, 0.55, 0.4)
part10.Position = Vector3.new(-0, -0.1, -0.625)
part10.Orientation = Vector3.new(0,90,180)
local part11 = Instance.new("Part") 
part11.CanCollide = false 
part11.CanQuery = false 
part11.Parent = handle
part11.Shape = "Cylinder"
part11.Material = Enum.Material.SmoothPlastic
part11.Color = Color3.fromRGB(202,203,209)
part11.Size = Vector3.new(0.3, 0.55, 2)
part11.Position = Vector3.new(-0, -0.1, -0.625)
part11.Orientation = Vector3.new(0,90,180)
local part12 = Instance.new("Part") 
part12.CanCollide = false 
part12.CanQuery = false 
part12.Parent = handle
part12.Shape = "Cylinder"
part12.Material = Enum.Material.SmoothPlastic
part12.Color = Color3.fromRGB(202,203,209)
part12.Size = Vector3.new(0.95, 0.05, 2)
part12.Position = Vector3.new(-0, -0.1, -0.625)
part12.Orientation = Vector3.new(45, 90, 90)
local part13 = Instance.new("Part") 
part13.CanCollide = false 
part13.CanQuery = false 
part13.Parent = handle
part13.Shape = "Cylinder"
part13.Material = Enum.Material.SmoothPlastic
part13.Color = Color3.fromRGB(202,203,209)
part13.Size = Vector3.new(0.95, 0.05, 2)
part13.Position = Vector3.new(-0, -0.1, -0.625)
part13.Orientation = Vector3.new(45,-90, -90)
local part14 = Instance.new("Part") 
part14.CanCollide = false 
part14.CanQuery = false 
part14.Parent = handle
part14.Shape = "Cylinder"
part14.Material = Enum.Material.SmoothPlastic
part14.Color = Color3.fromRGB(202,203,209)
part14.Size = Vector3.new(0.45, 0.05, 2)
part14.Position = Vector3.new(-0.282, 0.182, -0.818)
part14.Orientation = Vector3.new(-45, 90, -15)
local part15 = Instance.new("Part") 
part15.CanCollide = false 
part15.CanQuery = false 
part15.Parent = handle
part15.Shape = "Cylinder"
part15.Material = Enum.Material.SmoothPlastic
part15.Color = Color3.fromRGB(202,203,209)
part15.Size = Vector3.new(0.45, 0.05, 2)
part15.Position = Vector3.new(0.277, 0.177, -0.817)
part15.Orientation = Vector3.new(45, 90, -15)
local part16 = Instance.new("Part") 
part16.CanCollide = false 
part16.CanQuery = false 
part16.Parent = handle
part16.Shape = "Cylinder"
part16.Material = Enum.Material.SmoothPlastic
part16.Color = Color3.fromRGB(202,203,209)
part16.Size = Vector3.new(0.45, 0.05, 2)
part16.Position = Vector3.new(-0.277, -0.377, -0.817)
part16.Orientation = Vector3.new(45, 90, 15)
local part17 = Instance.new("Part") 
part17.CanCollide = false 
part17.CanQuery = false 
part17.Parent = handle
part17.Shape = "Cylinder"
part17.Material = Enum.Material.SmoothPlastic
part17.Color = Color3.fromRGB(202,203,209)
part17.Size = Vector3.new(0.45, 0.05, 2)
part17.Position = Vector3.new(0.282, -0.382, -0.818)
part17.Orientation = Vector3.new(-45, 90, 15)
local part18 = Instance.new("Part") 
part18.CanCollide = false 
part18.CanQuery = false 
part18.Parent = handle
part18.Material = Enum.Material.SmoothPlastic
part18.Color = Color3.fromRGB(202,203,209)
part18.Size = Vector3.new(0.03, 0.327, 0.036)
part18.Position = Vector3.new(0.009, 0.152, -0.755)	
local flashlightBase = Instance.new("SpecialMesh", part8) 
flashlightBase.MeshId = "rbxassetid://6300528939"
flashlightBase.Scale = Vector3.new(0.012, 0.012, 0.012)
local cylinder1  = Instance.new("Part", handle)
cylinder1.Shape = "Cylinder" --Blue Cylinder
cylinder1.Orientation = Vector3.new(0,90,180)
cylinder1.Position = Vector3.new(-0, -0.1, -0.25)
cylinder1.Size = Vector3.new(1.255,0.35, 2)
cylinder1.Material = Enum.Material.Glass
cylinder1.Color = Color3.fromRGB(17,17,17)
cylinder1.CanCollide = false -- Cylinder
cylinder1.CanQuery = false
local flashlightcircle  = Instance.new("Part", handle) --cylinder2
flashlightcircle.Shape = Enum.PartType.Ball 
flashlightcircle.Position = Vector3.new(0, -0.431, -0.865)
flashlightcircle.Orientation = Vector3.new(0, 90, 180)
flashlightcircle.Size = Vector3.new(0.001, 0.207, 0.22)
flashlightcircle.Material = Enum.Material.Glass
flashlightcircle.BrickColor = BrickColor.new("Really black")
flashlightcircle.CanCollide = false
flashlightcircle.CanQuery = false
local GGball = Instance.new("Part", handle) -- GG Field
GGball.Shape = Enum.PartType.Ball 
GGball.CanCollide = false 
GGball.CanQuery = false
GGball.BrickColor = BrickColor.new("Pastel Blue")
GGball.Transparency = 1
GGball.Material = Enum.Material.Neon
GGball.Position = Vector3.new(0.002, -0.1, -1.2)
GGball.Size = Vector3.new(0.29,0.29,0.29)
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = GGball
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = cylinder1
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = flashlightcircle
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part1
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part2
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part3
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part4
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part5
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part6
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part7
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part8
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part9
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part10
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part11
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part12
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part13
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part14
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part15
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part16
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part17
local weld = Instance.new("WeldConstraint", tool) --Welds
weld.Part0 = handle
weld.Part1 = part18
BShoot = Instance.new("Sound", handle)
BShoot.SoundId = "rbxassetid://182981554"
OShoot = Instance.new("Sound", handle)
OShoot.SoundId = "rbxassetid://142774034"
local gravitygun = Instance.new("Sound", handle)
gravitygun.Looped = true
gravitygun.SoundId = "rbxassetid://7449423195"
tool.Name = "Budget Portal Gun 2.0"
tool.ToolTip = "i promise its not made with plastic this time"
if character.Humanoid.RigType == Enum.HumanoidRigType.R6 then
	if VRService.VREnabled then 
		tool.GripPos = Vector3.new(0,-0.5,0)
	else
		tool.GripPos = Vector3.new(0.35,0.1,0.25)
	end
else
	if VRService.VREnabled then 
		tool.GripPos = Vector3.new(0,-0.5,0)
	else
		tool.GripPos = Vector3.new(0.2,-0.2,-0.1)
	end
end
tool.Parent = player.Backpack
local light = Instance.new("SpotLight", flashlightcircle)
light.Face = "Left"
light.Angle = 45
light.Brightness = 2
light.Range = 60
light.Enabled = false
local click = Instance.new("Sound", handle)
click.SoundId = "rbxassetid://5991592592"	
mouse.KeyDown:Connect(function(key)
	if key == "f" then 
		if tool.parent == player.Character and toolequipped == true and isHolding == false then
			click:Play()
			if light.Enabled == false then
				light.Enabled = true
				flashlightcircle.Material = Enum.Material.Neon
				flashlightcircle.BrickColor = BrickColor.new("White")
			else
				light.Enabled = false
				flashlightcircle.Material = Enum.Material.Glass
				flashlightcircle.BrickColor = BrickColor.new("Really black")
			end
		end
	end
end)
UserInputService.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Gamepad1 then
		if input.KeyCode == Enum.KeyCode.ButtonL2 then
			if tool.parent == player.Character and toolequipped == true and isHolding == false then
				click:Play()
				if light.Enabled == false then
					light.Enabled = true
					flashlightcircle.Material = Enum.Material.Neon
					flashlightcircle.BrickColor = BrickColor.new("White")
				else
					light.Enabled = false
					flashlightcircle.Material = Enum.Material.Glass
					flashlightcircle.BrickColor = BrickColor.new("Really black")
				end
			end
		end
	end
end)
tool.Equipped:Connect(function(mouse)
	if portal1 then
		game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683350503"
	end 
	if portal2 then
		game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683371140"
	end 
	if portal1 and portal2 then 
		game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683216197"
	end 
	if portal1 == nil and portal2 == nil then 
		game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683282532"
	end
	toolequipped = true
end)
tool.Unequipped:Connect(function(mouse)
	game.Players.LocalPlayer:GetMouse().Icon = ""
	toolequipped = false
	GrabObject = nil --stop grab
	isHolding = false
	GrabStart = false
	if Dragger then
		Dragger:Destroy()
		Dragger = nil
	end
	gravitygun:Stop()
	GGball.Transparency = 1
end)
-- Activate
mouse.Button1Down:Connect(function()
	if tool.parent == player.Character and toolequipped == true and isHolding == false then
		BShoot:Play()
		createportal(cylinder1.CFrame*CFrame.new(0,0,-2.7).Position,mouse.Hit.Position,mouse.Target,1)
		cylinder1.BrickColor = BrickColor.new("Bright blue") 
		cylinder1.Material = Enum.Material.Neon
	end
end)
UserInputService.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Gamepad1 then
		if input.KeyCode == Enum.KeyCode.ButtonB then
			if tool.Parent == player.Character and toolequipped == true and isHolding == false then
				OShoot:Play()
				createportal(cylinder1.CFrame*CFrame.new(0,0,-2.7).Position,mouse.Hit.Position,mouse.Target,2)
				cylinder1.BrickColor = BrickColor.new("Neon orange")
				cylinder1.Material = Enum.Material.Neon
			end
		end
	end
end)
mouse.Button2Down:Connect(function()
	if tool.parent == player.Character and toolequipped == true and isHolding == false then
		OShoot:Play()		
		createportal(cylinder1.CFrame*CFrame.new(0,0,-2.7).Position,mouse.Hit.Position,mouse.Target,2)
		cylinder1.BrickColor = BrickColor.new("Neon orange")
		cylinder1.Material = Enum.Material.Neon
	end
end)
--if you died then the portals are gone lol
character.Humanoid.Died:Connect(function()
	if tool then	
		tool:Destroy()
	end
	if portal1 then
		portal1:Destroy()
	end
	if portal2 then
		portal2:Destroy()
	end
	if portalin1 then
		portalin1:Destroy()
	end
	if portalin2 then
		portalin2:Destroy()
	end
	GrabObject = nil --stop grab
	isHolding = false
	GrabStart = false
	if Dragger then
		Dragger:Destroy()
		Dragger = nil
	end
end)
--Reseting Portals
mouse.KeyDown:Connect(function(key)
	if key == "r" then 
		if tool.parent == player.Character and toolequipped == true and isHolding == false then
			if portal1 then
				portal1:Destroy()	
				portalin1:Destroy()
			end
			if portal2 then
				portal2:Destroy()
				portalin2:Destroy()
			end
			portal1 = nil
			portal2 = nil
			tpcd = false
			cylinder1.Material = Enum.Material.Glass
			cylinder1.Color = Color3.fromRGB(17, 17, 17)
			if portal1 == nil and portal2 == nil then 
				game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683282532"
			end
		end
	end
end)
UserInputService.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Gamepad1 then
		if input.KeyCode == Enum.KeyCode.ButtonX then
			if tool.parent == player.Character and toolequipped == true and isHolding == false then
				if portal1 then
					portal1:Destroy()	
					portalin1:Destroy()
				end
				if portal2 then
					portal2:Destroy()
					portalin2:Destroy()
				end
				portal1 = nil
				portal2 = nil
				tpcd = false
				cylinder1.Material = Enum.Material.Glass
				cylinder1.Color = Color3.fromRGB(17, 17, 17)
				if portal1 == nil and portal2 == nil then 
					game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683282532"
				end
			end
		end
	end
end)
--Gravity Gun
UserInputService.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Gamepad1 then
		if input.KeyCode == Enum.KeyCode.ButtonY then
			if tool.parent == character and toolequipped == true then
				if isHolding == false then 
					--start grab
					local Magnitude = (mouse.Hit.Position - character.Head.CFrame.Position).magnitude
					if Magnitude < 10 then

						if not mouse.Target.Anchored then
							GrabObject = mouse.Target
							GrabStart = true
							isHolding = true	
							gravitygun:Play()
							GGball.Transparency = 0
							game.Players.LocalPlayer:GetMouse().Icon = ""

							local DragBall = createDragBall()
							DragBall.CFrame = mouse.hit
							Dragger = DragBall

							mouse.TargetFilter = GrabObject

							local DragBallWeld = weldBetween(DragBall,GrabObject)
							addMover(DragBall)

							while Dragger do
								--Create a ray from the users head to the mouse
								local cf = CFrame.new(character.Head.Position, mouse.Hit.Position)
								Dragger.Mover.Position = (cf + (cf.LookVector * 10)).Position
								Dragger.RotMover.CFrame = camera.CFrame * CFrame.Angles(Dragger.RotOffset.Value.X,Dragger.RotOffset.Value.Y, Dragger.RotOffset.Value.Z)
								wait()
							end
							mouse.TargetFilter = nil
						end
					end
				else
					GrabObject = nil --stop grab
					isHolding = false
					GrabStart = false
					gravitygun:Stop()
					if Dragger then
						Dragger:Destroy()
						Dragger = nil
					end
					GGball.Transparency = 1
					if portal1 then
						game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683350503"
					end 
					if portal2 then
						game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683371140"
					end 
					if portal1 and portal2 then 
						game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683216197"
					end 
					if portal1 == nil and portal2 == nil then 
						game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683282532"
					end
				end
			end
		end
	end
end)
mouse.KeyDown:Connect(function(key)
	if key == "e" then 
		if tool.parent == player.Character and toolequipped == true then
			if isHolding == false then 
				--start grab
				local Magnitude = (mouse.Hit.Position - character.Head.CFrame.Position).magnitude
				if Magnitude < 10 then

					if not mouse.Target.Anchored then
						GrabObject = mouse.Target
						GrabStart = true
						isHolding = true	
						gravitygun:Play()
						GGball.Transparency = 0
						game.Players.LocalPlayer:GetMouse().Icon = ""

						local DragBall = createDragBall()
						DragBall.CFrame = mouse.hit
						Dragger = DragBall

						mouse.TargetFilter = GrabObject

						local DragBallWeld = weldBetween(DragBall,GrabObject)
						addMover(DragBall)

						while Dragger do
							--Create a ray from the users head to the mouse
							local cf = CFrame.new(character.Head.Position, mouse.Hit.Position)
							Dragger.Mover.Position = (cf + (cf.LookVector * 10)).Position
							Dragger.RotMover.CFrame = camera.CFrame * CFrame.Angles(Dragger.RotOffset.Value.X,Dragger.RotOffset.Value.Y, Dragger.RotOffset.Value.Z)
							wait()
						end
						mouse.TargetFilter = nil
					end
				end
			else
				GrabObject = nil --stop grab
				isHolding = false
				GrabStart = false
				gravitygun:Stop()
				if Dragger then
					Dragger:Destroy()
					Dragger = nil
				end
				GGball.Transparency = 1
				if portal1 then
					game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683350503"
				end 
				if portal2 then
					game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683371140"
				end 
				if portal1 and portal2 then 
					game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683216197"
				end 
				if portal1 == nil and portal2 == nil then 
					game.Players.LocalPlayer:GetMouse().Icon = "rbxassetid://13683282532"
				end
			end
		end
	end
end)


function weldBetween(a, b)
	local weld = Instance.new("ManualWeld", a)
	weld.C0 = a.CFrame:inverse() * b.CFrame
	weld.Part0 = a
	weld.Part1 = b
	return weld
end


function addMover(part)
	local newMover = Instance.new("BodyPosition")
	newMover.Parent = part
	newMover.MaxForce = Vector3.new(40000,40000,40000)
	newMover.P = 40000
	newMover.D = 1000
	newMover.Position = part.Position
	newMover.Name = "Mover"

	local newRot = Instance.new("BodyGyro")
	newRot.Parent = part
	newRot.MaxTorque = Vector3.new(3000,3000,3000)
	newRot.P = 3000
	newRot.D = 500
	newRot.CFrame = game.Workspace.CurrentCamera.CFrame
	newRot.Name ="RotMover"

	local RotOffset = Instance.new("CFrameValue")
	RotOffset.Name = "RotOffset"
	RotOffset.Parent = part
end


function createDragBall()
	local DragBall = Instance.new("Part")
	DragBall.Transparency = 1
	DragBall.CanCollide = false
	DragBall.Size = Vector3.new(.2,.2,.2)
	DragBall.Shape = "Ball"
	DragBall.Name = "DragBall"
	DragBall.Parent = workspace
	return DragBall
end
--Arm Animation
if character.Humanoid.RigType == Enum.HumanoidRigType.R15 then
	--- Services ---
	local Players = game:GetService("Players");
	local RunService = game:GetService("RunService");
	wait();

	--- Declarations ---
	local Player = Players.LocalPlayer;
	local Character = Player.Character or Player.CharacterAdded:Wait();

	local Mouse = Player:GetMouse();

	--- Character ---
	local RightUpperArm = Character:WaitForChild("RightUpperArm");
	local RightShoulder = RightUpperArm:WaitForChild("RightShoulder");
	local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart");

	--- Execution ---
	RunService.Stepped:Connect(function()
		if toolequipped == true then
			local hit = Mouse.Hit;

			-- add the lookVector * 5000 to the hit.p to make the point more "dramatic" (remove it and you'll see why I did this)
			local direction = (hit.lookVector * 5000);

			-- get the rotation offset (so the arm points correctly depending on your rotation)
			local rootCFrame = HumanoidRootPart.CFrame;
			local rotationOffset = (rootCFrame - rootCFrame.p):inverse();

			-- since CFrames are relative, put the rotationOffset first, and then multiple by the point CFrame, and then multiple by the CFrame.Angles so the arm points in the right direction
			RightShoulder.Transform = rotationOffset * CFrame.new(Vector3.new(0, 0, 0), direction) * CFrame.Angles(math.pi / 2, 0, 0);
		end
	end)
else
	plr = game.Players.LocalPlayer;
	repeat
		wait()
	until plr.Character
	char = plr.Character
	m = plr:GetMouse()


	local origRightS = char:WaitForChild("Torso"):WaitForChild("Right Shoulder").C0
	local origLeftS = char:WaitForChild("Torso"):WaitForChild("Left Shoulder").C0
	local origNeck = char:WaitForChild("Torso"):WaitForChild("Neck").C0
	local camera = game.Workspace.CurrentCamera

	local UIS = game:GetService("UserInputService")

	local c = game.Workspace.CurrentCamera

	game:GetService("RunService").RenderStepped:Connect(function(delta)




		if toolequipped == true then

			if char.Torso:FindFirstChild("Right Shoulder") then
				char.Torso["Right Shoulder"].C0 = char.Torso["Right Shoulder"].C0:Lerp(CFrame.new(1, .65, 0) * CFrame.Angles(-math.asin((m.Origin.p - m.Hit.p).unit.y), 1.55, 0, 0) , 0.1)
			end
			if char.Torso:FindFirstChild("Left Shoulder") then
				char.Torso["Left Shoulder"].C0 = char.Torso["Left Shoulder"].C0:Lerp(CFrame.new(-1, .65, 0) * CFrame.Angles(-math.asin((m.Origin.p - m.Hit.p).unit.y), -1.55, 0, 0) , 0.1)
			end
			if char.Torso:FindFirstChild("Neck") then
				char.Torso["Neck"].C0 = char.Torso["Neck"].C0:Lerp(CFrame.new(0, 1, 0) * CFrame.Angles(-math.asin((m.Origin.p - m.Hit.p).unit.y) + 1.55, 3.15, 0), 0.2)
			end

		else

			if char.Torso:FindFirstChild("Right Shoulder") then
				char.Torso["Right Shoulder"].C0 = char.Torso["Right Shoulder"].C0:lerp(origRightS, 0.1)
			end


			if char.Torso:FindFirstChild("Left Shoulder") then
				char.Torso["Left Shoulder"].C0 = char.Torso["Left Shoulder"].C0:lerp(origLeftS, 0.1)
			end



			if char.Torso:FindFirstChild("Neck") then
				char.Torso["Neck"].C0 = char.Torso["Neck"].C0:lerp(origNeck, 0.1)
			end
		end
	end)
end
--spyglass
while task.wait() do
	local UserInputService = game:GetService("UserInputService")
	local Keybind = UserInputService:IsKeyDown(Enum.KeyCode.C)
	local camera = game.Workspace.CurrentCamera
	local targetFOV = Keybind and 20 or 70

	if camera.FieldOfView ~= targetFOV then
		camera.FieldOfView = math.clamp(camera.FieldOfView + (targetFOV - camera.FieldOfView) * 0.4, 0, 480)
	end
end